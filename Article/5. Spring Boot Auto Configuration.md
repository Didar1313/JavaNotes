## ЁЯкД **How Spring Boot Auto Configuration Works Internally (Behind-the-Scenes Magic)**

Spring Boot-ржПрж░ рж╕ржмржЪрзЗрзЯрзЗ ржЕрж╕рж╛ржзрж╛рж░ржг ржлрж┐ржЪрж╛рж░ржЧрзБрж▓рзЛрж░ ржПржХржЯрж╛ рж╣ржЪрзНржЫрзЗ **Auto Configuration**ред
ржЖржорж░рж╛ ржЕржирзЗржХ рж╕ржорзЯ Spring Boot ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐, ржХрж┐ржирзНрждрзБ ржЦрзБржм ржХржо рж╕ржорзЯ ржПржЯрж╛ ржирж┐рзЯрзЗ ржнрж╛ржмрж┐ тАФ
**Spring Boot ржХрзАржнрж╛ржмрзЗ ржирж┐ржЬрзЗ ржирж┐ржЬрзЗржЗ рж╕ржм ржХрж┐ржЫрзБ рждрзИрж░рж┐ ржХрж░рзЗ ржлрзЗрж▓рзЗ?**

ржЪрж▓рзБржи, ржПрж░ ржнрж┐рждрж░рзЗрж░ ржорзНржпрж╛ржЬрж┐ржХржЯрж╛ ржмрзБржЭрзЗ ржирзЗржЗред

---

## ЁЯЪА Spring Boot ржПрж░ ржорзВрж▓ ржирзАрждрж┐:

> **"Convention over Configuration"**
> ржорж╛ржирзЗ, ржЖржорж░рж╛ ржпржжрж┐ рж╕рж╛ржзрж╛рж░ржгржнрж╛ржмрзЗ ржХрж┐ржЫрзБ ржХрж░рж┐, Spring ржирж┐ржЬрзЗржЗ ржмрзБржЭрзЗ ржирзЗрзЯ ржХрзА ржжрж░ржХрж╛рж░, ржХржЦржи ржжрж░ржХрж╛рж░, ржХрзАржнрж╛ржмрзЗ ржХрж░рждрзЗ рж╣ржмрзЗред

---

### ЁЯУж ржзрж░рзБржи ржЖржорж░рж╛ рж╢рзБржзрзБ ржПржЯрзБржХрзБ ржХрзЛржб рж▓рж┐ржЦрж┐ тАФ

```java
@SpringBootApplication
public class MyApp {}
```

ржПрж░ржкрж░ ржЖржорж░рж╛ ржпржжрж┐ `spring-boot-starter-data-jpa` dependency ржпрзЛржЧ ржХрж░рж┐, ржЖрж░ `application.properties`-ржП рж▓рж┐ржЦрж┐:

```properties
spring.datasource.url=jdbc:mysql://localhost:3306/testdb
```

ржЖржорж░рж╛ ржХрзЛржерж╛ржУ ржмрж▓рж┐ржирж┐ ржХрзАржнрж╛ржмрзЗ `DataSource`, `EntityManagerFactory`, ржмрж╛ `TransactionManager` рждрзИрж░рж┐ рж╣ржмрзЗред
рждржмрзБржУ Spring Boot рж╕ржм ржХрж┐ржЫрзБ рждрзИрж░рж┐ ржХрж░рзЗ ржлрзЗрж▓рзЗ!
**ржЪрж▓рзБржи ржжрзЗржЦрж┐, ржХрзАржнрж╛ржмрзЗ ржПржЯрж╛ рж╕ржорзНржнржм рж╣рзЯред**

---

## ЁЯФН 1. `@SpringBootApplication` ржПрж░ ржнрж┐рждрж░рзЗ ржХрзА ржерж╛ржХрзЗ?

```java
@SpringBootApplication =
    @SpringBootConfiguration +
    @EnableAutoConfiguration +
    @ComponentScan
```

ЁЯФС ржПржЗ рждрж┐ржиржЯрж╛ annotation ржПржХрж╕рж╛ржерзЗ ржорж┐рж▓рзЗржЗ Spring Boot-ржПрж░ main setup ржХрж░рзЗ ржжрзЗрзЯред

---

## тЬи 2. `@EnableAutoConfiguration`: ржорзВрж▓ ржорзНржпрж╛ржЬрж┐ржХ ржПржЦрж╛ржирзЗржЗ

ржПржЗ annotation Spring Boot-ржХрзЗ ржмрж▓рзЗ:

> тАЬрж╕ржм `META-INF/spring.factories` ржлрж╛ржЗрж▓ ржкрзЬрзЛ, ржЖрж░ ржпрзЗрж╕ржм `@Configuration` class ржЙрж▓рзНрж▓рзЗржЦ ржЖржЫрзЗ, рж╕рзЗржЧрзБрж▓рзЛ load ржХрж░рзЗ ржлрзЗрж▓рзЛредтАЭ

```java
// META-INF/spring.factories (Spring Boot 2.x)
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
...
```

Spring Boot ржПржЗ рж▓рж┐рж╕рзНржЯ ржерзЗржХрзЗ ржПржХрзЗ ржПржХрзЗ рж╕ржм **Auto Configuration classes** рж▓рзЛржб ржХрж░рзЗред

---

## тЪЩя╕П 3. Auto Configuration Class Example:

```java
@Configuration
@ConditionalOnClass(DataSource.class)
@ConditionalOnProperty(prefix = "spring.datasource", name = "url")
public class DataSourceAutoConfiguration {
    
    @Bean
    @ConditionalOnMissingBean
    public DataSource dataSource() {
        // Create & return HikariDataSource or BasicDataSource
    }
}
```

### ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рж┐:

* `@ConditionalOnClass` тЮд classpath-ржП `DataSource` ржХрзНрж▓рж╛рж╕ ржЖржЫрзЗ ржХрж┐ ржирж╛, рж╕рзЗржЯрж╛ ржжрзЗржЦрзЗ
* `@ConditionalOnProperty` тЮд ржЖржорж░рж╛ ржХрж┐ `spring.datasource.url` ржжрж┐рзЯрзЗржЫрж┐?
* `@ConditionalOnMissingBean` тЮд ржЖржорж░рж╛ ржпржжрж┐ ржирж┐ржЬрзЗ `DataSource` Bean ржирж╛ рждрзИрж░рж┐ ржХрж░рж┐, рждржЦржи Spring ржирж┐ржЬрзЗржЗ рждрзИрж░рж┐ ржХрж░рзЗ

ржПржЗржнрж╛ржмрзЗ Spring Boot **рж╢рж░рзНрждржнрж┐рждрзНрждрж┐ржХ Bean рждрзИрж░рж┐ ржХрж░рзЗ**ред

---

## ЁЯза 4. Condition-based Loading

Auto Configuration рж╢рзБржзрзБ рждржЦржиржЗ ржХрж╛ржЬ ржХрж░рзЗ ржпржЦржи ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж┐ржЫрзБ **condition** ржорж┐рж▓рзЗ ржпрж╛рзЯред

ржирж╛рж╣рж▓рзЗ Spring ржХрж┐ржЫрзБржЗ ржХрж░рзЗ ржирж╛ тАФ ржЖржорж╛ржжрзЗрж░ ржирж┐ржЬрж╕рзНржм Bean ржмрж╛ ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржиржХрзЗ override ржХрж░рзЗ ржирж╛ред

### ржХрж┐ржЫрзБ Common Condition Annotation:

| Annotation                     | ржХрж╛ржЬ                                           |
| ------------------------------ | --------------------------------------------- |
| `@ConditionalOnClass`          | ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрзНрж▓рж╛рж╕ ржерж╛ржХрж▓рзЗ ржЪрж╛рж▓рзБ рж╣ржмрзЗ                |
| `@ConditionalOnMissingBean`    | ржЖржорж░рж╛ ржпржжрж┐ Bean рждрзИрж░рж┐ ржирж╛ ржХрж░рж┐                     |
| `@ConditionalOnProperty`       | properties ржлрж╛ржЗрж▓рзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ property рж╕рзЗржЯ ржерж╛ржХрж▓рзЗ |
| `@ConditionalOnWebApplication` | Web Application рж╣рж▓рзЗ ржЪрж╛рж▓рзБ рж╣ржмрзЗ                  |

---

## ЁЯзк 5. Auto Configuration Debug ржХрж░ржм ржХрзАржнрж╛ржмрзЗ?

Spring Boot ржЪрж╛рж▓рзБ ржХрж░рж╛рж░ рж╕ржорзЯ ржЖржорж░рж╛ ржжрзЗржЦрждрзЗ ржкрж╛рж░рж┐ ржХрзЛржи ржХрзЛржи auto configuration apply рж╣рзЯрзЗржЫрзЗред

```properties
spring.main.log-startup-info=true
```

ржЕржержмрж╛ ржЪрж▓рждрзЗ ржкрж╛рж░рж┐:

```bash
java -Ddebug -jar our-app.jar
```

ржПрждрзЗ ржжрзЗржЦрж╛ ржпрж╛ржмрзЗ тАФ ржХрзЛржи ржХрзЛржи Auto Configuration apply рж╣рзЯрзЗржЫрзЗ, ржХрзЛржиржЧрзБрж▓рзЛ skip рж╣рзЯрзЗржЫрзЗ ржПржмржВ **ржХрзЗржи** рж╣рзЯрзЗржЫрзЗред

---

## ЁЯУж Bonus: Spring Boot 3.x-ржП ржкрж░рж┐ржмрж░рзНрждржи

Spring Boot 3.x ржерзЗржХрзЗ `spring.factories`-ржПрж░ ржЬрж╛рзЯржЧрж╛рзЯ ржЗржЙржЬ рж╣ржЪрзНржЫрзЗ:

```
META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports
```

ржПржЯрж╛ scanning process-ржХрзЗ ржЖрж░ржУ рж╣рж╛рж▓ржХрж╛ ржПржмржВ efficient ржХрж░рзЗ рждрзБрж▓рзЗржЫрзЗред

---

## тЬи Moral of the Story:

> Spring Boot Auto Configuration =
> ржПржХ ржЕрж╕рж╛ржзрж╛рж░ржг ржПржмржВ рж╕рзНржорж╛рж░рзНржЯ ржмрзНржпржмрж╕рзНржерж╛,
> ржпрзЗржЦрж╛ржирзЗ Spring classpath, properties, ржПржмржВ Bean presence ржжрзЗржЦрзЗ
> conditionally ржкрзНрж░рзЯрзЛржЬржирзАрзЯ Bean ржЧрзБрж▓рзЛ configure ржХрж░рзЗ ржлрзЗрж▓рзЗ тАФ
> ржпрзЗржи ржЖржорж░рж╛ рж╢рзБржзрзБ **business logic**-ржП ржоржирзЛржпрзЛржЧ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ред


